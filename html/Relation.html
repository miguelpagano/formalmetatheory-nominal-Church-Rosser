<!DOCTYPE HTML>
<html><head><meta charset="utf-8"><title>Relation</title><link rel="stylesheet" href="Agda.css"></head><body><pre class="Agda"><a id="1" class="Background">%include lhs2TeX.fmt
\long\def\ignore#1{}

\begin{document}

\section{Reflexive and Transitve Clousure of a Relation}

\ignore{
</a><a id="129" class="Markup">\begin{code}</a>
<a id="142" class="Keyword">open</a> <a id="147" class="Keyword">import</a> <a id="154" href="Level.html" class="Module">Level</a> <a id="160" class="Keyword">hiding</a> <a id="167" class="Symbol">(</a><a id="168" href="Agda.Primitive.html#575" class="Primitive">zero</a><a id="172" class="Symbol">)</a>
<a id="174" class="Keyword">module</a> <a id="181" href="Relation.html" class="Module">Relation</a> <a id="190" class="Symbol">{</a><a id="191" href="Relation.html#191" class="Bound">l</a> <a id="193" class="Symbol">:</a> <a id="195" href="Agda.Primitive.html#408" class="Postulate">Level</a><a id="200" class="Symbol">}</a> <a id="202" class="Symbol">(</a><a id="203" href="Relation.html#203" class="Bound">A</a> <a id="205" class="Symbol">:</a> <a id="207" class="PrimitiveType">Set</a> <a id="211" href="Relation.html#191" class="Bound">l</a><a id="212" class="Symbol">)</a> <a id="214" class="Keyword">where</a>

  <a id="223" class="Keyword">open</a> <a id="228" class="Keyword">import</a> <a id="235" href="Relation.Nullary.html" class="Module">Relation.Nullary</a>
  <a id="254" class="Keyword">import</a> <a id="261" href="Relation.Binary.html" class="Module">Relation.Binary</a> <a id="277" class="Symbol">as</a> <a id="280" class="Module">RB</a>
  <a id="285" class="Keyword">import</a> <a id="292" href="Relation.Unary.html" class="Module">Relation.Unary</a> <a id="307" class="Symbol">as</a> <a id="310" class="Module">RU</a>
  <a id="315" class="Keyword">open</a> <a id="320" class="Keyword">import</a> <a id="327" href="Data.Product.html" class="Module">Data.Product</a>
  <a id="342" class="Keyword">open</a> <a id="347" class="Keyword">import</a> <a id="354" href="Data.Sum.html" class="Module">Data.Sum</a>
  <a id="365" class="Keyword">open</a> <a id="370" class="Keyword">import</a> <a id="377" href="Relation.Binary.PropositionalEquality.html" class="Module">Relation.Binary.PropositionalEquality</a> <a id="415" class="Symbol">as</a> <a id="418" class="Module">PropEq</a> <a id="425" class="Keyword">renaming</a> <a id="434" class="Symbol">(</a><a id="435" href="Relation.Binary.PropositionalEquality.html#2356" class="InductiveConstructor Operator">[_]</a> <a id="439" class="Symbol">to</a> <a id="Binary.PropositionalEquality.[_]"></a><a id="442" href="Relation.html#442" class="InductiveConstructor Operator">[_]ᵢ</a><a id="446" class="Symbol">)</a> <a id="448" class="Keyword">hiding</a> <a id="455" class="Symbol">(</a><a id="456" href="Relation.Binary.PropositionalEquality.Core.html#1729" class="Function">trans</a><a id="461" class="Symbol">)</a>
<a id="463" class="Markup">\end{code}</a><a id="473" class="Background">
}

\ignore{
</a><a id="486" class="Markup">\begin{code}</a>
  <a id="Rel"></a><a id="501" href="Relation.html#501" class="Function">Rel</a> <a id="505" class="Symbol">:</a> <a id="507" class="PrimitiveType">Set</a> <a id="511" class="Symbol">(</a><a id="512" href="Agda.Primitive.html#591" class="Primitive">suc</a> <a id="516" href="Relation.html#191" class="Bound">l</a><a id="517" class="Symbol">)</a>
  <a id="521" href="Relation.html#501" class="Function">Rel</a> <a id="525" class="Symbol">=</a> <a id="527" href="Relation.Binary.Core.html#882" class="Function">RB.Rel</a> <a id="534" href="Relation.html#203" class="Bound">A</a> <a id="536" href="Relation.html#191" class="Bound">l</a>
<a id="538" class="Markup">\end{code}</a><a id="548" class="Background">

</a><a id="550" class="Markup">\begin{code}</a>
  <a id="Pred"></a><a id="565" href="Relation.html#565" class="Function">Pred</a> <a id="570" class="Symbol">:</a> <a id="572" class="PrimitiveType">Set</a> <a id="576" class="Symbol">(</a><a id="577" href="Agda.Primitive.html#591" class="Primitive">suc</a> <a id="581" href="Relation.html#191" class="Bound">l</a><a id="582" class="Symbol">)</a>
  <a id="586" href="Relation.html#565" class="Function">Pred</a> <a id="591" class="Symbol">=</a> <a id="593" href="Relation.Unary.html#1101" class="Function">RU.Pred</a> <a id="601" href="Relation.html#203" class="Bound">A</a> <a id="603" href="Relation.html#191" class="Bound">l</a>

  <a id="608" class="Keyword">infix</a> <a id="614" class="Number">2</a> <a id="616" href="Relation.html#633" class="Function Operator">_preserved-by_</a>
  <a id="_preserved-by_"></a><a id="633" href="Relation.html#633" class="Function Operator">_preserved-by_</a> <a id="648" class="Symbol">:</a> <a id="650" href="Relation.html#565" class="Function">Pred</a> <a id="655" class="Symbol">→</a> <a id="657" href="Relation.html#501" class="Function">Rel</a> <a id="661" class="Symbol">→</a> <a id="663" class="PrimitiveType">Set</a> <a id="667" href="Relation.html#191" class="Bound">l</a>
  <a id="671" href="Relation.html#671" class="Bound">P</a> <a id="673" href="Relation.html#633" class="Function Operator">preserved-by</a> <a id="686" href="Relation.html#686" class="Bound">R</a> <a id="688" class="Symbol">=</a> <a id="690" class="Symbol">∀</a> <a id="692" class="Symbol">{</a><a id="693" href="Relation.html#693" class="Bound">M</a> <a id="695" href="Relation.html#695" class="Bound">N</a> <a id="697" class="Symbol">:</a> <a id="699" href="Relation.html#203" class="Bound">A</a><a id="700" class="Symbol">}</a> <a id="702" class="Symbol">→</a> <a id="704" href="Relation.html#671" class="Bound">P</a> <a id="706" href="Relation.html#693" class="Bound">M</a> <a id="708" class="Symbol">→</a> <a id="710" href="Relation.html#686" class="Bound">R</a> <a id="712" href="Relation.html#693" class="Bound">M</a> <a id="714" href="Relation.html#695" class="Bound">N</a> <a id="716" class="Symbol">→</a> <a id="718" href="Relation.html#671" class="Bound">P</a> <a id="720" href="Relation.html#695" class="Bound">N</a>
<a id="722" class="Markup">\end{code}</a><a id="732" class="Background">


The dual $R^{\mathit{op}}$ of a relation $R$ is defined by swapping the pairs.

</a><a id="815" class="Markup">\begin{code}</a>
  <a id="dual"></a><a id="830" href="Relation.html#830" class="Function">dual</a> <a id="835" class="Symbol">:</a> <a id="837" href="Relation.html#501" class="Function">Rel</a> <a id="841" class="Symbol">→</a> <a id="843" href="Relation.html#501" class="Function">Rel</a>
  <a id="849" href="Relation.html#830" class="Function">dual</a> <a id="854" href="Relation.html#854" class="Bound">R</a> <a id="856" href="Relation.html#856" class="Bound">m</a> <a id="858" href="Relation.html#858" class="Bound">n</a> <a id="860" class="Symbol">=</a> <a id="862" href="Relation.html#854" class="Bound">R</a> <a id="864" href="Relation.html#858" class="Bound">n</a> <a id="866" href="Relation.html#856" class="Bound">m</a>

  <a id="871" class="Comment">-- dual-idem : (R : Rel) → dual (dual R) ≡ R</a>
  <a id="918" class="Comment">-- dual-idem R = {! refl!}</a>
<a id="945" class="Markup">\end{code}</a><a id="955" class="Background">

Given two relations $R$ and $S$ over $A$ we can take their union.

</a><a id="1024" class="Markup">\begin{code}</a>
  <a id="1039" class="Keyword">infix</a> <a id="1045" class="Number">5</a> <a id="1047" href="Relation.html#1053" class="Function Operator">_∪_</a>
  <a id="_∪_"></a><a id="1053" href="Relation.html#1053" class="Function Operator">_∪_</a>  <a id="1058" class="Symbol">:</a> <a id="1060" class="Symbol">(</a><a id="1061" href="Relation.html#1061" class="Bound">R</a> <a id="1063" href="Relation.html#1063" class="Bound">S</a> <a id="1065" class="Symbol">:</a> <a id="1067" href="Relation.html#501" class="Function">Rel</a><a id="1070" class="Symbol">)</a> <a id="1072" class="Symbol">→</a> <a id="1074" href="Relation.html#501" class="Function">Rel</a>
  <a id="1080" href="Relation.html#1053" class="Function Operator">_∪_</a> <a id="1084" href="Relation.html#1084" class="Bound">R</a> <a id="1086" href="Relation.html#1086" class="Bound">S</a> <a id="1088" href="Relation.html#1088" class="Bound">a</a> <a id="1090" href="Relation.html#1090" class="Bound">b</a> <a id="1092" class="Symbol">=</a> <a id="1094" href="Relation.html#1084" class="Bound">R</a> <a id="1096" href="Relation.html#1088" class="Bound">a</a> <a id="1098" href="Relation.html#1090" class="Bound">b</a> <a id="1100" href="Data.Sum.Base.html#734" class="Datatype Operator">⊎</a> <a id="1102" href="Relation.html#1086" class="Bound">S</a> <a id="1104" href="Relation.html#1088" class="Bound">a</a> <a id="1106" href="Relation.html#1090" class="Bound">b</a>
<a id="1108" class="Markup">\end{code}</a><a id="1118" class="Background">

Binary relations can be pre-ordered by inclusion, $R$ is less than or
equal to $S$ when $a\,R\,b$ implies $a\,S\,b$; as usual we write $R
\subseteq S$.

</a><a id="1273" class="Markup">\begin{code}</a>
  <a id="_⊆_"></a><a id="1288" href="Relation.html#1288" class="Function Operator">_⊆_</a> <a id="1292" class="Symbol">:</a> <a id="1294" href="Relation.html#501" class="Function">Rel</a> <a id="1298" class="Symbol">→</a> <a id="1300" href="Relation.html#501" class="Function">Rel</a> <a id="1304" class="Symbol">→</a> <a id="1306" class="PrimitiveType">Set</a> <a id="1310" href="Relation.html#191" class="Bound">l</a>
  <a id="1314" href="Relation.html#1314" class="Bound">R</a> <a id="1316" href="Relation.html#1288" class="Function Operator">⊆</a> <a id="1318" href="Relation.html#1318" class="Bound">S</a> <a id="1320" class="Symbol">=</a> <a id="1322" href="Relation.Binary.Core.html#1254" class="Function Operator">RB._⇒_</a> <a id="1329" href="Relation.html#1314" class="Bound">R</a> <a id="1331" href="Relation.html#1318" class="Bound">S</a>

  <a id="refl-⊆"></a><a id="1336" href="Relation.html#1336" class="Function">refl-⊆</a> <a id="1343" class="Symbol">:</a> <a id="1345" class="Symbol">{</a><a id="1346" href="Relation.html#1346" class="Bound">R</a> <a id="1348" class="Symbol">:</a> <a id="1350" href="Relation.html#501" class="Function">Rel</a><a id="1353" class="Symbol">}</a> <a id="1355" class="Symbol">→</a> <a id="1357" href="Relation.html#1346" class="Bound">R</a> <a id="1359" href="Relation.html#1288" class="Function Operator">⊆</a> <a id="1361" href="Relation.html#1346" class="Bound">R</a>
  <a id="1365" href="Relation.html#1336" class="Function">refl-⊆</a> <a id="1372" href="Relation.html#1372" class="Bound">aRb</a> <a id="1376" class="Symbol">=</a> <a id="1378" href="Relation.html#1372" class="Bound">aRb</a>

  <a id="trans-⊆"></a><a id="1385" href="Relation.html#1385" class="Function">trans-⊆</a> <a id="1393" class="Symbol">:</a> <a id="1395" class="Symbol">{</a><a id="1396" href="Relation.html#1396" class="Bound">R</a> <a id="1398" href="Relation.html#1398" class="Bound">S</a> <a id="1400" href="Relation.html#1400" class="Bound">T</a> <a id="1402" class="Symbol">:</a> <a id="1404" href="Relation.html#501" class="Function">Rel</a><a id="1407" class="Symbol">}</a> <a id="1409" class="Symbol">→</a> <a id="1411" href="Relation.html#1396" class="Bound">R</a> <a id="1413" href="Relation.html#1288" class="Function Operator">⊆</a> <a id="1415" href="Relation.html#1398" class="Bound">S</a> <a id="1417" class="Symbol">→</a> <a id="1419" href="Relation.html#1398" class="Bound">S</a> <a id="1421" href="Relation.html#1288" class="Function Operator">⊆</a> <a id="1423" href="Relation.html#1400" class="Bound">T</a> <a id="1425" class="Symbol">→</a> <a id="1427" href="Relation.html#1396" class="Bound">R</a> <a id="1429" href="Relation.html#1288" class="Function Operator">⊆</a> <a id="1431" href="Relation.html#1400" class="Bound">T</a>
  <a id="1435" href="Relation.html#1385" class="Function">trans-⊆</a> <a id="1443" href="Relation.html#1443" class="Bound">R⊆S</a> <a id="1447" href="Relation.html#1447" class="Bound">S⊆T</a> <a id="1451" href="Relation.html#1451" class="Bound">aRb</a> <a id="1455" class="Symbol">=</a> <a id="1457" href="Relation.html#1447" class="Bound">S⊆T</a> <a id="1461" class="Symbol">(</a><a id="1462" href="Relation.html#1443" class="Bound">R⊆S</a> <a id="1466" href="Relation.html#1451" class="Bound">aRb</a><a id="1469" class="Symbol">)</a>
<a id="1471" class="Markup">\end{code}</a><a id="1481" class="Background">
}

The reflexive and transitive closure of a relation is more naturally
introduced by allowing more than one steps in the transitive clause.
Some immediate facts about the transitive closure of an operation is
that it is monotone and idempotent (besides these two properties one
asks that the closure of $R$ contains $R$, but this is immediate from
the definition). From these two properties we prove that $R \subseteq
\transclos S$ implies $\transclos R \subseteq \transclos S$
(alternatively one can proceed by induction on $a\,\transclos R\,b$); it is
straightforward to prove the other

</a><a id="2073" class="Markup">\begin{code}</a>
  <a id="2088" class="Keyword">data</a> <a id="star"></a><a id="2093" href="Relation.html#2093" class="Datatype">star</a> <a id="2098" class="Symbol">(</a><a id="2099" href="Relation.html#2099" class="Bound">⟿</a> <a id="2101" class="Symbol">:</a> <a id="2103" href="Relation.html#501" class="Function">Rel</a><a id="2106" class="Symbol">)</a> <a id="2108" class="Symbol">:</a> <a id="2110" href="Relation.html#501" class="Function">Rel</a> <a id="2114" class="Keyword">where</a>
    <a id="star.refl"></a><a id="2124" href="Relation.html#2124" class="InductiveConstructor">refl</a> <a id="2129" class="Symbol">:</a> <a id="2131" class="Symbol">∀</a> <a id="2133" class="Symbol">{</a><a id="2134" href="Relation.html#2134" class="Bound">a</a><a id="2135" class="Symbol">}</a> <a id="2137" class="Symbol">→</a> <a id="2139" href="Relation.html#2093" class="Datatype">star</a> <a id="2144" href="Relation.html#2099" class="Bound">⟿</a> <a id="2146" href="Relation.html#2134" class="Bound">a</a> <a id="2148" href="Relation.html#2134" class="Bound">a</a>
    <a id="star.just"></a><a id="2154" href="Relation.html#2154" class="InductiveConstructor">just</a> <a id="2159" class="Symbol">:</a> <a id="2161" class="Symbol">∀</a> <a id="2163" class="Symbol">{</a><a id="2164" href="Relation.html#2164" class="Bound">a</a> <a id="2166" href="Relation.html#2166" class="Bound">b</a><a id="2167" class="Symbol">}</a> <a id="2169" class="Symbol">→</a> <a id="2171" href="Relation.html#2099" class="Bound">⟿</a> <a id="2173" href="Relation.html#2164" class="Bound">a</a> <a id="2175" href="Relation.html#2166" class="Bound">b</a> <a id="2177" class="Symbol">→</a> <a id="2179" href="Relation.html#2093" class="Datatype">star</a> <a id="2184" href="Relation.html#2099" class="Bound">⟿</a> <a id="2186" href="Relation.html#2164" class="Bound">a</a> <a id="2188" href="Relation.html#2166" class="Bound">b</a>
    <a id="star.trans"></a><a id="2194" href="Relation.html#2194" class="InductiveConstructor">trans</a> <a id="2200" class="Symbol">:</a> <a id="2202" class="Symbol">∀</a> <a id="2204" class="Symbol">{</a><a id="2205" href="Relation.html#2205" class="Bound">a</a> <a id="2207" href="Relation.html#2207" class="Bound">b</a> <a id="2209" href="Relation.html#2209" class="Bound">c</a> <a id="2211" class="Symbol">}</a> <a id="2213" class="Symbol">→</a> <a id="2215" href="Relation.html#2093" class="Datatype">star</a> <a id="2220" href="Relation.html#2099" class="Bound">⟿</a> <a id="2222" href="Relation.html#2205" class="Bound">a</a> <a id="2224" href="Relation.html#2207" class="Bound">b</a> <a id="2226" class="Symbol">→</a> <a id="2228" href="Relation.html#2093" class="Datatype">star</a> <a id="2233" href="Relation.html#2099" class="Bound">⟿</a> <a id="2235" href="Relation.html#2207" class="Bound">b</a> <a id="2237" href="Relation.html#2209" class="Bound">c</a> <a id="2239" class="Symbol">→</a> <a id="2241" href="Relation.html#2093" class="Datatype">star</a> <a id="2246" href="Relation.html#2099" class="Bound">⟿</a> <a id="2248" href="Relation.html#2205" class="Bound">a</a> <a id="2250" href="Relation.html#2209" class="Bound">c</a>

  <a id="mon-star"></a><a id="2255" href="Relation.html#2255" class="Function">mon-star</a> <a id="2264" class="Symbol">:</a> <a id="2266" class="Symbol">{</a><a id="2267" href="Relation.html#2267" class="Bound">R</a> <a id="2269" href="Relation.html#2269" class="Bound">S</a> <a id="2271" class="Symbol">:</a> <a id="2273" href="Relation.html#501" class="Function">Rel</a><a id="2276" class="Symbol">}</a> <a id="2278" class="Symbol">→</a> <a id="2280" href="Relation.html#2267" class="Bound">R</a> <a id="2282" href="Relation.html#1288" class="Function Operator">⊆</a> <a id="2284" href="Relation.html#2269" class="Bound">S</a> <a id="2286" class="Symbol">→</a> <a id="2288" href="Relation.html#2093" class="Datatype">star</a> <a id="2293" href="Relation.html#2267" class="Bound">R</a> <a id="2295" href="Relation.html#1288" class="Function Operator">⊆</a> <a id="2297" href="Relation.html#2093" class="Datatype">star</a> <a id="2302" href="Relation.html#2269" class="Bound">S</a>
  <a id="2306" href="Relation.html#2255" class="Function">mon-star</a> <a id="2315" href="Relation.html#2315" class="Bound">R⊆S</a> <a id="2319" href="Relation.html#2124" class="InductiveConstructor">refl</a> <a id="2324" class="Symbol">=</a> <a id="2326" href="Relation.html#2124" class="InductiveConstructor">refl</a>
  <a id="2333" href="Relation.html#2255" class="Function">mon-star</a> <a id="2342" href="Relation.html#2342" class="Bound">R⊆S</a> <a id="2346" class="Symbol">(</a><a id="2347" href="Relation.html#2154" class="InductiveConstructor">just</a> <a id="2352" href="Relation.html#2352" class="Bound">aRb</a><a id="2355" class="Symbol">)</a> <a id="2357" class="Symbol">=</a> <a id="2359" href="Relation.html#2154" class="InductiveConstructor">just</a> <a id="2364" class="Symbol">(</a><a id="2365" href="Relation.html#2342" class="Bound">R⊆S</a> <a id="2369" href="Relation.html#2352" class="Bound">aRb</a><a id="2372" class="Symbol">)</a>
  <a id="2376" href="Relation.html#2255" class="Function">mon-star</a> <a id="2385" href="Relation.html#2385" class="Bound">R⊆S</a> <a id="2389" class="Symbol">(</a><a id="2390" href="Relation.html#2194" class="InductiveConstructor">trans</a> <a id="2396" href="Relation.html#2396" class="Bound">aR⋆b</a> <a id="2401" href="Relation.html#2401" class="Bound">bR⋆c</a><a id="2405" class="Symbol">)</a>
    <a id="2411" class="Symbol">=</a> <a id="2413" href="Relation.html#2194" class="InductiveConstructor">trans</a> <a id="2419" class="Symbol">(</a><a id="2420" href="Relation.html#2255" class="Function">mon-star</a> <a id="2429" href="Relation.html#2385" class="Bound">R⊆S</a> <a id="2433" href="Relation.html#2396" class="Bound">aR⋆b</a><a id="2437" class="Symbol">)</a> <a id="2439" class="Symbol">(</a><a id="2440" href="Relation.html#2255" class="Function">mon-star</a> <a id="2449" href="Relation.html#2385" class="Bound">R⊆S</a> <a id="2453" href="Relation.html#2401" class="Bound">bR⋆c</a><a id="2457" class="Symbol">)</a>

  <a id="idem-star"></a><a id="2462" href="Relation.html#2462" class="Function">idem-star</a> <a id="2472" class="Symbol">:</a> <a id="2474" class="Symbol">{</a><a id="2475" href="Relation.html#2475" class="Bound">R</a> <a id="2477" class="Symbol">:</a> <a id="2479" href="Relation.html#501" class="Function">Rel</a><a id="2482" class="Symbol">}</a> <a id="2484" class="Symbol">→</a> <a id="2486" href="Relation.html#2093" class="Datatype">star</a> <a id="2491" class="Symbol">(</a><a id="2492" href="Relation.html#2093" class="Datatype">star</a> <a id="2497" href="Relation.html#2475" class="Bound">R</a><a id="2498" class="Symbol">)</a> <a id="2500" href="Relation.html#1288" class="Function Operator">⊆</a> <a id="2502" href="Relation.html#2093" class="Datatype">star</a> <a id="2507" href="Relation.html#2475" class="Bound">R</a>
  <a id="2511" href="Relation.html#2462" class="Function">idem-star</a> <a id="2521" href="Relation.html#2124" class="InductiveConstructor">refl</a> <a id="2526" class="Symbol">=</a> <a id="2528" href="Relation.html#2124" class="InductiveConstructor">refl</a>
  <a id="2535" href="Relation.html#2462" class="Function">idem-star</a> <a id="2545" class="Symbol">(</a><a id="2546" href="Relation.html#2154" class="InductiveConstructor">just</a> <a id="2551" href="Relation.html#2551" class="Bound">aRb</a><a id="2554" class="Symbol">)</a> <a id="2556" class="Symbol">=</a> <a id="2558" href="Relation.html#2551" class="Bound">aRb</a>
  <a id="2564" href="Relation.html#2462" class="Function">idem-star</a> <a id="2574" class="Symbol">(</a><a id="2575" href="Relation.html#2194" class="InductiveConstructor">trans</a> <a id="2581" href="Relation.html#2581" class="Bound">aR⋆b</a> <a id="2586" href="Relation.html#2586" class="Bound">bR⋆c</a><a id="2590" class="Symbol">)</a> <a id="2592" class="Symbol">=</a> <a id="2594" href="Relation.html#2194" class="InductiveConstructor">trans</a> <a id="2600" class="Symbol">(</a><a id="2601" href="Relation.html#2462" class="Function">idem-star</a> <a id="2611" href="Relation.html#2581" class="Bound">aR⋆b</a><a id="2615" class="Symbol">)</a> <a id="2617" class="Symbol">(</a><a id="2618" href="Relation.html#2462" class="Function">idem-star</a> <a id="2628" href="Relation.html#2586" class="Bound">bR⋆c</a><a id="2632" class="Symbol">)</a>

  <a id="trans-⊆-star"></a><a id="2637" href="Relation.html#2637" class="Function">trans-⊆-star</a> <a id="2650" class="Symbol">:</a> <a id="2652" class="Symbol">{</a><a id="2653" href="Relation.html#2653" class="Bound">R</a> <a id="2655" href="Relation.html#2655" class="Bound">S</a> <a id="2657" class="Symbol">:</a> <a id="2659" href="Relation.html#501" class="Function">Rel</a><a id="2662" class="Symbol">}</a> <a id="2664" class="Symbol">→</a> <a id="2666" href="Relation.html#2653" class="Bound">R</a> <a id="2668" href="Relation.html#1288" class="Function Operator">⊆</a> <a id="2670" href="Relation.html#2093" class="Datatype">star</a> <a id="2675" href="Relation.html#2655" class="Bound">S</a> <a id="2677" class="Symbol">→</a> <a id="2679" href="Relation.html#2093" class="Datatype">star</a> <a id="2684" href="Relation.html#2653" class="Bound">R</a> <a id="2686" href="Relation.html#1288" class="Function Operator">⊆</a> <a id="2688" href="Relation.html#2093" class="Datatype">star</a> <a id="2693" href="Relation.html#2655" class="Bound">S</a>
  <a id="2697" href="Relation.html#2637" class="Function">trans-⊆-star</a> <a id="2710" class="Symbol">{</a><a id="2711" href="Relation.html#2711" class="Bound">R</a><a id="2712" class="Symbol">}</a> <a id="2714" class="Symbol">{</a><a id="2715" href="Relation.html#2715" class="Bound">S</a><a id="2716" class="Symbol">}</a> <a id="2718" href="Relation.html#2718" class="Bound">R⊆S⋆</a>
    <a id="2727" class="Symbol">=</a> <a id="2729" href="Relation.html#1385" class="Function">trans-⊆</a>  <a id="2738" class="Symbol">{</a><a id="2739" href="Relation.html#2093" class="Datatype">star</a> <a id="2744" href="Relation.html#2711" class="Bound">R</a><a id="2745" class="Symbol">}</a> <a id="2747" class="Symbol">{</a><a id="2748" href="Relation.html#2093" class="Datatype">star</a> <a id="2753" class="Symbol">(</a><a id="2754" href="Relation.html#2093" class="Datatype">star</a> <a id="2759" href="Relation.html#2715" class="Bound">S</a><a id="2760" class="Symbol">)}</a> <a id="2763" class="Symbol">{</a><a id="2764" href="Relation.html#2093" class="Datatype">star</a> <a id="2769" href="Relation.html#2715" class="Bound">S</a><a id="2770" class="Symbol">}</a>
               <a id="2787" class="Symbol">(</a><a id="2788" href="Relation.html#2255" class="Function">mon-star</a> <a id="2797" href="Relation.html#2718" class="Bound">R⊆S⋆</a><a id="2801" class="Symbol">)</a>
               <a id="2818" href="Relation.html#2462" class="Function">idem-star</a>
<a id="2828" class="Markup">\end{code}</a><a id="2838" class="Background">

Our next goal is to prove that the diamond property implies
Church-Rosser; for this it turns out that dealing with the usual
definition of the reflexive transitive closure is not convenient,
because the termination checker is not convinced about the use of the
inductive hypothesis in one case. In order to bypass this obstacle we
present another formalisation of the reflexive and transitive closure
of a relation $R^\omega = \bigcup_{n\in \mathbb N} R^n$; although
these two notions are not isomorphic (when passing from $\transclos R$ to
$R^{\omega}$ we lane all the single steps to the left), they are
equivalent.

</a><a id="3459" class="Markup">\begin{code}</a>
  <a id="3474" class="Keyword">data</a> <a id="steps"></a><a id="3479" href="Relation.html#3479" class="Datatype">steps</a> <a id="3485" class="Symbol">(</a><a id="3486" href="Relation.html#3486" class="Bound">⟿</a> <a id="3488" class="Symbol">:</a> <a id="3490" href="Relation.html#501" class="Function">Rel</a><a id="3493" class="Symbol">)</a> <a id="3495" class="Symbol">:</a> <a id="3497" href="Relation.html#501" class="Function">Rel</a> <a id="3501" class="Keyword">where</a>
    <a id="steps.zero"></a><a id="3511" href="Relation.html#3511" class="InductiveConstructor">zero</a>  <a id="3517" class="Symbol">:</a> <a id="3519" class="Symbol">∀</a> <a id="3521" class="Symbol">{</a><a id="3522" href="Relation.html#3522" class="Bound">a</a><a id="3523" class="Symbol">}</a>                               <a id="3555" class="Symbol">→</a> <a id="3557" href="Relation.html#3479" class="Datatype">steps</a> <a id="3563" href="Relation.html#3486" class="Bound">⟿</a> <a id="3565" href="Relation.html#3522" class="Bound">a</a> <a id="3567" href="Relation.html#3522" class="Bound">a</a>
    <a id="steps.one"></a><a id="3573" href="Relation.html#3573" class="InductiveConstructor">one</a>   <a id="3579" class="Symbol">:</a> <a id="3581" class="Symbol">∀</a> <a id="3583" class="Symbol">{</a><a id="3584" href="Relation.html#3584" class="Bound">a</a> <a id="3586" href="Relation.html#3586" class="Bound">b</a><a id="3587" class="Symbol">}</a>    <a id="3592" class="Symbol">→</a> <a id="3594" href="Relation.html#3486" class="Bound">⟿</a> <a id="3596" href="Relation.html#3584" class="Bound">a</a> <a id="3598" href="Relation.html#3586" class="Bound">b</a>                 <a id="3616" class="Symbol">→</a> <a id="3618" href="Relation.html#3479" class="Datatype">steps</a> <a id="3624" href="Relation.html#3486" class="Bound">⟿</a> <a id="3626" href="Relation.html#3584" class="Bound">a</a> <a id="3628" href="Relation.html#3586" class="Bound">b</a>
    <a id="steps.more"></a><a id="3634" href="Relation.html#3634" class="InductiveConstructor">more</a>  <a id="3640" class="Symbol">:</a> <a id="3642" class="Symbol">∀</a> <a id="3644" class="Symbol">{</a><a id="3645" href="Relation.html#3645" class="Bound">a</a> <a id="3647" href="Relation.html#3647" class="Bound">b</a> <a id="3649" href="Relation.html#3649" class="Bound">c</a><a id="3650" class="Symbol">}</a>  <a id="3653" class="Symbol">→</a> <a id="3655" href="Relation.html#3486" class="Bound">⟿</a> <a id="3657" href="Relation.html#3645" class="Bound">a</a> <a id="3659" href="Relation.html#3647" class="Bound">b</a> <a id="3661" class="Symbol">→</a> <a id="3663" href="Relation.html#3479" class="Datatype">steps</a> <a id="3669" href="Relation.html#3486" class="Bound">⟿</a> <a id="3671" href="Relation.html#3647" class="Bound">b</a> <a id="3673" href="Relation.html#3649" class="Bound">c</a>  <a id="3676" class="Symbol">→</a> <a id="3678" href="Relation.html#3479" class="Datatype">steps</a> <a id="3684" href="Relation.html#3486" class="Bound">⟿</a> <a id="3686" href="Relation.html#3645" class="Bound">a</a> <a id="3688" href="Relation.html#3649" class="Bound">c</a>

  <a id="_++_"></a><a id="3693" href="Relation.html#3693" class="Function Operator">_++_</a> <a id="3698" class="Symbol">:</a>  <a id="3701" class="Symbol">{</a><a id="3702" href="Relation.html#3702" class="Bound">⟿</a> <a id="3704" class="Symbol">:</a> <a id="3706" href="Relation.html#501" class="Function">Rel</a><a id="3709" class="Symbol">}</a> <a id="3711" class="Symbol">{</a><a id="3712" href="Relation.html#3712" class="Bound">a</a> <a id="3714" href="Relation.html#3714" class="Bound">b</a> <a id="3716" href="Relation.html#3716" class="Bound">c</a> <a id="3718" class="Symbol">:</a> <a id="3720" href="Relation.html#203" class="Bound">A</a><a id="3721" class="Symbol">}</a>
          <a id="3733" class="Symbol">→</a> <a id="3735" href="Relation.html#3479" class="Datatype">steps</a> <a id="3741" href="Relation.html#3702" class="Bound">⟿</a> <a id="3743" href="Relation.html#3712" class="Bound">a</a> <a id="3745" href="Relation.html#3714" class="Bound">b</a> <a id="3747" class="Symbol">→</a> <a id="3749" href="Relation.html#3479" class="Datatype">steps</a> <a id="3755" href="Relation.html#3702" class="Bound">⟿</a> <a id="3757" href="Relation.html#3714" class="Bound">b</a> <a id="3759" href="Relation.html#3716" class="Bound">c</a> <a id="3761" class="Symbol">→</a> <a id="3763" href="Relation.html#3479" class="Datatype">steps</a> <a id="3769" href="Relation.html#3702" class="Bound">⟿</a> <a id="3771" href="Relation.html#3712" class="Bound">a</a> <a id="3773" href="Relation.html#3716" class="Bound">c</a>
  <a id="3777" href="Relation.html#3511" class="InductiveConstructor">zero</a> <a id="3782" href="Relation.html#3693" class="Function Operator">++</a> <a id="3785" href="Relation.html#3785" class="Bound">s&#39;</a> <a id="3788" class="Symbol">=</a> <a id="3790" href="Relation.html#3785" class="Bound">s&#39;</a>
  <a id="3795" href="Relation.html#3573" class="InductiveConstructor">one</a> <a id="3799" href="Relation.html#3799" class="Bound">a⟿b</a> <a id="3803" href="Relation.html#3693" class="Function Operator">++</a> <a id="3806" href="Relation.html#3806" class="Bound">b⟿*c</a> <a id="3811" class="Symbol">=</a> <a id="3813" href="Relation.html#3634" class="InductiveConstructor">more</a> <a id="3818" href="Relation.html#3799" class="Bound">a⟿b</a> <a id="3822" href="Relation.html#3806" class="Bound">b⟿*c</a>
  <a id="3829" href="Relation.html#3634" class="InductiveConstructor">more</a> <a id="3834" href="Relation.html#3834" class="Bound">a⟿b</a> <a id="3838" href="Relation.html#3838" class="Bound">b⟿*c</a> <a id="3843" href="Relation.html#3693" class="Function Operator">++</a> <a id="3846" href="Relation.html#3846" class="Bound">c⟿*d</a> <a id="3851" class="Symbol">=</a> <a id="3853" href="Relation.html#3634" class="InductiveConstructor">more</a> <a id="3858" href="Relation.html#3834" class="Bound">a⟿b</a> <a id="3862" class="Symbol">(</a><a id="3863" href="Relation.html#3838" class="Bound">b⟿*c</a> <a id="3868" href="Relation.html#3693" class="Function Operator">++</a> <a id="3871" href="Relation.html#3846" class="Bound">c⟿*d</a><a id="3875" class="Symbol">)</a>

  <a id="⋆-to-ω"></a><a id="3880" href="Relation.html#3880" class="Function">⋆-to-ω</a> <a id="3887" class="Symbol">:</a> <a id="3889" class="Symbol">∀</a> <a id="3891" class="Symbol">{</a><a id="3892" href="Relation.html#3892" class="Bound">a</a> <a id="3894" href="Relation.html#3894" class="Bound">b</a> <a id="3896" href="Relation.html#3896" class="Bound">⟿</a><a id="3897" class="Symbol">}</a> <a id="3899" class="Symbol">→</a> <a id="3901" href="Relation.html#2093" class="Datatype">star</a> <a id="3906" href="Relation.html#3896" class="Bound">⟿</a> <a id="3908" href="Relation.html#3892" class="Bound">a</a> <a id="3910" href="Relation.html#3894" class="Bound">b</a> <a id="3912" class="Symbol">→</a> <a id="3914" href="Relation.html#3479" class="Datatype">steps</a> <a id="3920" href="Relation.html#3896" class="Bound">⟿</a> <a id="3922" href="Relation.html#3892" class="Bound">a</a> <a id="3924" href="Relation.html#3894" class="Bound">b</a>
  <a id="3928" href="Relation.html#3880" class="Function">⋆-to-ω</a> <a id="3935" href="Relation.html#2124" class="InductiveConstructor">refl</a> <a id="3940" class="Symbol">=</a> <a id="3942" href="Relation.html#3511" class="InductiveConstructor">zero</a>
  <a id="3949" href="Relation.html#3880" class="Function">⋆-to-ω</a> <a id="3956" class="Symbol">(</a><a id="3957" href="Relation.html#2154" class="InductiveConstructor">just</a> <a id="3962" href="Relation.html#3962" class="Bound">a⟿b</a><a id="3965" class="Symbol">)</a> <a id="3967" class="Symbol">=</a> <a id="3969" href="Relation.html#3573" class="InductiveConstructor">one</a> <a id="3973" href="Relation.html#3962" class="Bound">a⟿b</a>
  <a id="3979" href="Relation.html#3880" class="Function">⋆-to-ω</a> <a id="3986" class="Symbol">(</a><a id="3987" href="Relation.html#2194" class="InductiveConstructor">trans</a> <a id="3993" href="Relation.html#3993" class="Bound">a⟿*b</a> <a id="3998" href="Relation.html#3998" class="Bound">b⟿*c</a><a id="4002" class="Symbol">)</a> <a id="4004" class="Symbol">=</a> <a id="4006" href="Relation.html#3880" class="Function">⋆-to-ω</a> <a id="4013" href="Relation.html#3993" class="Bound">a⟿*b</a> <a id="4018" href="Relation.html#3693" class="Function Operator">++</a> <a id="4021" href="Relation.html#3880" class="Function">⋆-to-ω</a> <a id="4028" href="Relation.html#3998" class="Bound">b⟿*c</a>

  <a id="ω-to-⋆"></a><a id="4036" href="Relation.html#4036" class="Function">ω-to-⋆</a> <a id="4043" class="Symbol">:</a> <a id="4045" class="Symbol">∀</a> <a id="4047" class="Symbol">{</a><a id="4048" href="Relation.html#4048" class="Bound">a</a> <a id="4050" href="Relation.html#4050" class="Bound">b</a> <a id="4052" href="Relation.html#4052" class="Bound">⟿</a><a id="4053" class="Symbol">}</a> <a id="4055" class="Symbol">→</a> <a id="4057" href="Relation.html#3479" class="Datatype">steps</a> <a id="4063" href="Relation.html#4052" class="Bound">⟿</a> <a id="4065" href="Relation.html#4048" class="Bound">a</a> <a id="4067" href="Relation.html#4050" class="Bound">b</a> <a id="4069" class="Symbol">→</a> <a id="4071" href="Relation.html#2093" class="Datatype">star</a> <a id="4076" href="Relation.html#4052" class="Bound">⟿</a> <a id="4078" href="Relation.html#4048" class="Bound">a</a> <a id="4080" href="Relation.html#4050" class="Bound">b</a>
  <a id="4084" href="Relation.html#4036" class="Function">ω-to-⋆</a> <a id="4091" href="Relation.html#3511" class="InductiveConstructor">zero</a> <a id="4096" class="Symbol">=</a> <a id="4098" href="Relation.html#2124" class="InductiveConstructor">refl</a>
  <a id="4105" href="Relation.html#4036" class="Function">ω-to-⋆</a> <a id="4112" class="Symbol">(</a><a id="4113" href="Relation.html#3573" class="InductiveConstructor">one</a> <a id="4117" href="Relation.html#4117" class="Bound">a⟿b</a><a id="4120" class="Symbol">)</a> <a id="4122" class="Symbol">=</a> <a id="4124" href="Relation.html#2154" class="InductiveConstructor">just</a> <a id="4129" href="Relation.html#4117" class="Bound">a⟿b</a>
  <a id="4135" href="Relation.html#4036" class="Function">ω-to-⋆</a> <a id="4142" class="Symbol">(</a><a id="4143" href="Relation.html#3634" class="InductiveConstructor">more</a> <a id="4148" href="Relation.html#4148" class="Bound">a⟿b</a> <a id="4152" href="Relation.html#4152" class="Bound">b⟿*c</a><a id="4156" class="Symbol">)</a> <a id="4158" class="Symbol">=</a> <a id="4160" href="Relation.html#2194" class="InductiveConstructor">trans</a> <a id="4166" class="Symbol">(</a><a id="4167" href="Relation.html#2154" class="InductiveConstructor">just</a> <a id="4172" href="Relation.html#4148" class="Bound">a⟿b</a><a id="4175" class="Symbol">)</a> <a id="4177" class="Symbol">(</a><a id="4178" href="Relation.html#4036" class="Function">ω-to-⋆</a> <a id="4185" href="Relation.html#4152" class="Bound">b⟿*c</a><a id="4189" class="Symbol">)</a>
<a id="4191" class="Markup">\end{code}</a><a id="4201" class="Background">

A relation $R$ is said to have the \emph{diamond} property if whenever
$a\,R\,b$ and $a\,R\,c$, there is a $d$ such that $b\,R\,d$ and
$c\,R\,d$; we will say that $R$ is \emph{diamantine} if it satisfies
the diamond property.

\begin{minipage}{0.7\textwidth}
</a><a id="4462" class="Markup">\begin{code}</a>
  <a id="diamond"></a><a id="4477" href="Relation.html#4477" class="Function">diamond</a> <a id="4485" class="Symbol">:</a> <a id="4487" class="Symbol">(</a><a id="4488" href="Relation.html#4488" class="Bound Operator">_⟿_</a> <a id="4492" class="Symbol">:</a> <a id="4494" href="Relation.html#501" class="Function">Rel</a><a id="4497" class="Symbol">)</a> <a id="4499" class="Symbol">→</a> <a id="4501" class="PrimitiveType">Set</a> <a id="4505" href="Relation.html#191" class="Bound">l</a>
  <a id="4509" href="Relation.html#4477" class="Function">diamond</a> <a id="4517" href="Relation.html#4517" class="Bound Operator">_⟿_</a> <a id="4521" class="Symbol">=</a>  <a id="4524" class="Symbol">{</a><a id="4525" href="Relation.html#4525" class="Bound">a</a> <a id="4527" href="Relation.html#4527" class="Bound">b</a> <a id="4529" href="Relation.html#4529" class="Bound">c</a> <a id="4531" class="Symbol">:</a> <a id="4533" href="Relation.html#203" class="Bound">A</a><a id="4534" class="Symbol">}</a>
                  <a id="4554" class="Symbol">→</a> <a id="4556" href="Relation.html#4525" class="Bound">a</a> <a id="4558" href="Relation.html#4517" class="Bound Operator">⟿</a> <a id="4560" href="Relation.html#4527" class="Bound">b</a> <a id="4562" class="Symbol">→</a> <a id="4564" href="Relation.html#4525" class="Bound">a</a> <a id="4566" href="Relation.html#4517" class="Bound Operator">⟿</a> <a id="4568" href="Relation.html#4529" class="Bound">c</a> <a id="4570" class="Symbol">→</a>
                  <a id="4590" href="Data.Product.html#1369" class="Function">∃</a> <a id="4592" class="Symbol">(λ</a> <a id="4595" href="Relation.html#4595" class="Bound">d</a> <a id="4597" class="Symbol">→</a> <a id="4599" href="Relation.html#4527" class="Bound">b</a> <a id="4601" href="Relation.html#4517" class="Bound Operator">⟿</a> <a id="4603" href="Relation.html#4595" class="Bound">d</a> <a id="4605" href="Data.Product.html#1167" class="Function Operator">×</a> <a id="4607" href="Relation.html#4529" class="Bound">c</a> <a id="4609" href="Relation.html#4517" class="Bound Operator">⟿</a> <a id="4611" href="Relation.html#4595" class="Bound">d</a><a id="4612" class="Symbol">)</a>
<a id="4614" class="Markup">\end{code}</a><a id="4624" class="Background">
\end{minipage}
\begin{minipage}{0.3\textwidth}
\begin{tikzpicture}[&gt;=latex]
   \node (a) at (2,2) {$a$};
   \node (b) at (1,1) {$b$};
   \node (c) at (3,1) {$c$};
   \node (d) at (2,0) {$d$};

   \draw [-&gt;] (a) -- (b) ;
   \draw [-&gt;] (a) -- (c) ;
   \draw[dashed,-&gt;] (b) -- (d) ;
   \draw[dashed,-&gt;] (c) -&gt; (d) ;
\end{tikzpicture}
\end{minipage}

A relation $R$ is \emph{Church-Rosser} if its transitive closure is
diamantine; as we have already mentioned it is easier to deal with the
statement of Church-Rosser for the $n$-fold version of the transitive
closure.

</a><a id="5191" class="Markup">\begin{code}</a>
  <a id="cr"></a><a id="5206" href="Relation.html#5206" class="Function">cr</a> <a id="5209" class="Symbol">:</a> <a id="5211" class="Symbol">(</a><a id="5212" href="Relation.html#5212" class="Bound">⟿</a> <a id="5214" class="Symbol">:</a> <a id="5216" href="Relation.html#501" class="Function">Rel</a><a id="5219" class="Symbol">)</a> <a id="5221" class="Symbol">→</a> <a id="5223" class="PrimitiveType">Set</a> <a id="5227" href="Relation.html#191" class="Bound">l</a>
  <a id="5231" href="Relation.html#5206" class="Function">cr</a> <a id="5234" href="Relation.html#5234" class="Bound">⟿</a> <a id="5236" class="Symbol">=</a> <a id="5238" href="Relation.html#4477" class="Function">diamond</a> <a id="5246" class="Symbol">(</a><a id="5247" href="Relation.html#2093" class="Datatype">star</a> <a id="5252" href="Relation.html#5234" class="Bound">⟿</a><a id="5253" class="Symbol">)</a>

  <a id="cr-steps"></a><a id="5258" href="Relation.html#5258" class="Function">cr-steps</a> <a id="5267" class="Symbol">:</a> <a id="5269" class="Symbol">(</a><a id="5270" href="Relation.html#5270" class="Bound">⟿</a> <a id="5272" class="Symbol">:</a> <a id="5274" href="Relation.html#501" class="Function">Rel</a><a id="5277" class="Symbol">)</a> <a id="5279" class="Symbol">→</a> <a id="5281" class="PrimitiveType">Set</a> <a id="5285" href="Relation.html#191" class="Bound">l</a>
  <a id="5289" href="Relation.html#5258" class="Function">cr-steps</a> <a id="5298" href="Relation.html#5298" class="Bound">⟿</a> <a id="5300" class="Symbol">=</a> <a id="5302" href="Relation.html#4477" class="Function">diamond</a> <a id="5310" class="Symbol">(</a><a id="5311" href="Relation.html#3479" class="Datatype">steps</a> <a id="5317" href="Relation.html#5298" class="Bound">⟿</a><a id="5318" class="Symbol">)</a>

  <a id="cr-steps-to-cr"></a><a id="5323" href="Relation.html#5323" class="Function">cr-steps-to-cr</a> <a id="5338" class="Symbol">:</a> <a id="5340" class="Symbol">{</a><a id="5341" href="Relation.html#5341" class="Bound">⟿</a> <a id="5343" class="Symbol">:</a> <a id="5345" href="Relation.html#501" class="Function">Rel</a><a id="5348" class="Symbol">}</a> <a id="5350" class="Symbol">→</a> <a id="5352" href="Relation.html#5258" class="Function">cr-steps</a> <a id="5361" href="Relation.html#5341" class="Bound">⟿</a> <a id="5363" class="Symbol">→</a> <a id="5365" href="Relation.html#5206" class="Function">cr</a> <a id="5368" href="Relation.html#5341" class="Bound">⟿</a>
  <a id="5372" href="Relation.html#5323" class="Function">cr-steps-to-cr</a> <a id="5387" href="Relation.html#5387" class="Bound">cr</a> <a id="5390" href="Relation.html#5390" class="Bound">a⟿*b</a> <a id="5395" href="Relation.html#5395" class="Bound">a⟿*c</a>
    <a id="5404" class="Keyword">with</a> <a id="5409" href="Relation.html#5387" class="Bound">cr</a> <a id="5412" class="Symbol">(</a><a id="5413" href="Relation.html#3880" class="Function">⋆-to-ω</a> <a id="5420" href="Relation.html#5390" class="Bound">a⟿*b</a><a id="5424" class="Symbol">)</a> <a id="5426" class="Symbol">(</a><a id="5427" href="Relation.html#3880" class="Function">⋆-to-ω</a> <a id="5434" href="Relation.html#5395" class="Bound">a⟿*c</a><a id="5438" class="Symbol">)</a>
  <a id="5442" class="Symbol">...</a> <a id="5446" class="Symbol">|</a> <a id="5448" href="Relation.html#5448" class="Bound">d</a> <a id="5450" href="Agda.Builtin.Sigma.html#209" class="InductiveConstructor Operator">,</a> <a id="5452" href="Relation.html#5452" class="Bound">b⟿*d</a> <a id="5457" href="Agda.Builtin.Sigma.html#209" class="InductiveConstructor Operator">,</a> <a id="5459" href="Relation.html#5459" class="Bound">c⟿*d</a> <a id="5464" class="Symbol">=</a> <a id="5466" href="Relation.html#5448" class="Bound">d</a> <a id="5468" href="Agda.Builtin.Sigma.html#209" class="InductiveConstructor Operator">,</a> <a id="5470" href="Relation.html#4036" class="Function">ω-to-⋆</a> <a id="5477" href="Relation.html#5452" class="Bound">b⟿*d</a> <a id="5482" href="Agda.Builtin.Sigma.html#209" class="InductiveConstructor Operator">,</a> <a id="5484" href="Relation.html#4036" class="Function">ω-to-⋆</a> <a id="5491" href="Relation.html#5459" class="Bound">c⟿*d</a>
<a id="5496" class="Markup">\end{code}</a><a id="5506" class="Background">

\begin{lemma}
Let $\reduction$ have the diamond property; if there is a reduction
$\reduces a b$ and also a reduction $\reducesn a c$, then there exists
$d$ such that $\reducesn b d$ and $\reduces c d$.
\end{lemma}
\begin{proof}
The proof is by induction in the length of $\reduces a c$:

\begin{tikzpicture}[&gt;=latex,baseline]
   \node (a) at (2,2) {$a$};
   \node (b) at (1,1) {$b$};
   \node (c) at (3,1) {$a$};
   \node (d) at (2,0) {$b$};

   \draw [-&gt;] (a) -- (b) ;
   \draw [double] (a) -- (c) ;
   \draw [double] (b) -- (d) ;
   \draw[-&gt;] (c) -&gt; (d) ;
\end{tikzpicture}
\quad
\begin{tikzpicture}[&gt;=latex,baseline]
   \node (a) at (2,2) {$a$};
   \node (b) at (1,1) {$b$};
   \node (c) at (3,1) {$c$};
   \node (d) at (2,0) {$d$};
   \node (diamond) at (2,1) {$\diamond$} ;

   \draw [-&gt;] (a) -- (b) ;
   \draw [-&gt;] (a) -- (c) ;
   \draw [-&gt;] (b) -- (d) ;
   \draw[-&gt;] (c) -&gt; (d) ;
\end{tikzpicture}
\quad
\begin{tikzpicture}[&gt;=latex,baseline]
   \node (a) at (2,2) {$a$};
   \node (b) at (1,1) {$b$};
   \node (c1) at (3,1) {$c$};
   \node (cn) at (5,-1) {$c_n$};
   \node (d1) at (2,0) {$d_1$};
   \node (dn) at (4,-2) {$d_n$};
   \node (diamond) at (2,1) {$\diamond$} ;
   \node (ih) at (3,0) {i.h.};

   \draw [-&gt;] (a) -- (b) ;
   \draw [-&gt;] (a) -- (c1) ;
   \draw [-&gt;] (c1) -- (cn) ;
   \draw[-&gt;] (c1) -&gt; (d1) ;
   \draw[-&gt;] (b) -&gt; (d1) ;
   \draw[-&gt;] (d1) -&gt; (dn) ;
   \draw[-&gt;] (cn) -&gt; (dn) ;
\end{tikzpicture}

\end{proof}

</a><a id="6946" class="Markup">\begin{code}</a>
  <a id="leg"></a><a id="6961" href="Relation.html#6961" class="Function">leg</a> <a id="6965" class="Symbol">:</a>  <a id="6968" class="Symbol">∀</a> <a id="6970" class="Symbol">{</a><a id="6971" href="Relation.html#6971" class="Bound">a</a> <a id="6973" href="Relation.html#6973" class="Bound">b</a> <a id="6975" href="Relation.html#6975" class="Bound">c</a> <a id="6977" href="Relation.html#6977" class="Bound">⟿</a><a id="6978" class="Symbol">}</a>
         <a id="6989" class="Symbol">→</a> <a id="6991" href="Relation.html#4477" class="Function">diamond</a> <a id="6999" href="Relation.html#6977" class="Bound">⟿</a>
         <a id="7010" class="Symbol">→</a> <a id="7012" href="Relation.html#6977" class="Bound">⟿</a> <a id="7014" href="Relation.html#6971" class="Bound">a</a> <a id="7016" href="Relation.html#6973" class="Bound">b</a>
         <a id="7027" class="Symbol">→</a> <a id="7029" href="Relation.html#3479" class="Datatype">steps</a> <a id="7035" href="Relation.html#6977" class="Bound">⟿</a> <a id="7037" href="Relation.html#6971" class="Bound">a</a> <a id="7039" href="Relation.html#6975" class="Bound">c</a>
         <a id="7050" class="Symbol">→</a> <a id="7052" href="Data.Product.html#1369" class="Function">∃</a> <a id="7054" class="Symbol">(λ</a> <a id="7057" href="Relation.html#7057" class="Bound">d</a> <a id="7059" class="Symbol">→</a> <a id="7061" href="Relation.html#3479" class="Datatype">steps</a> <a id="7067" href="Relation.html#6977" class="Bound">⟿</a> <a id="7069" href="Relation.html#6973" class="Bound">b</a> <a id="7071" href="Relation.html#7057" class="Bound">d</a> <a id="7073" href="Data.Product.html#1167" class="Function Operator">×</a> <a id="7075" href="Relation.html#6977" class="Bound">⟿</a> <a id="7077" href="Relation.html#6975" class="Bound">c</a> <a id="7079" href="Relation.html#7057" class="Bound">d</a><a id="7080" class="Symbol">)</a>
  <a id="7084" href="Relation.html#6961" class="Function">leg</a> <a id="7088" class="Symbol">{</a><a id="7089" href="Relation.html#7089" class="Bound">a</a><a id="7090" class="Symbol">}</a> <a id="7092" class="Symbol">{</a><a id="7093" href="Relation.html#7093" class="Bound">b</a><a id="7094" class="Symbol">}</a> <a id="7096" href="Relation.html#7096" class="Bound">♢</a> <a id="7098" href="Relation.html#7098" class="Bound">a⟿b</a> <a id="7102" href="Relation.html#3511" class="InductiveConstructor">zero</a>    <a id="7110" class="Symbol">=</a> <a id="7112" href="Relation.html#7093" class="Bound">b</a> <a id="7114" href="Agda.Builtin.Sigma.html#209" class="InductiveConstructor Operator">,</a> <a id="7116" href="Relation.html#3511" class="InductiveConstructor">zero</a> <a id="7121" href="Agda.Builtin.Sigma.html#209" class="InductiveConstructor Operator">,</a> <a id="7123" href="Relation.html#7098" class="Bound">a⟿b</a>
  <a id="7129" href="Relation.html#6961" class="Function">leg</a> <a id="7133" class="Symbol">{</a><a id="7134" href="Relation.html#7134" class="Bound">a</a><a id="7135" class="Symbol">}</a> <a id="7137" class="Symbol">{</a><a id="7138" href="Relation.html#7138" class="Bound">b</a><a id="7139" class="Symbol">}</a> <a id="7141" class="Symbol">{</a><a id="7142" href="Relation.html#7142" class="Bound">c</a><a id="7143" class="Symbol">}</a> <a id="7145" href="Relation.html#7145" class="Bound">♢</a> <a id="7147" href="Relation.html#7147" class="Bound">a⟿b</a> <a id="7151" class="Symbol">(</a><a id="7152" href="Relation.html#3573" class="InductiveConstructor">one</a> <a id="7156" href="Relation.html#7156" class="Bound">a⟿c</a><a id="7159" class="Symbol">)</a>
    <a id="7165" class="Keyword">with</a> <a id="7170" href="Relation.html#7145" class="Bound">♢</a> <a id="7172" href="Relation.html#7147" class="Bound">a⟿b</a> <a id="7176" href="Relation.html#7156" class="Bound">a⟿c</a>
  <a id="7182" class="Symbol">...</a> <a id="7186" class="Symbol">|</a> <a id="7188" href="Relation.html#7188" class="Bound">d</a> <a id="7190" href="Agda.Builtin.Sigma.html#209" class="InductiveConstructor Operator">,</a> <a id="7192" href="Relation.html#7192" class="Bound">b⟿d</a> <a id="7196" href="Agda.Builtin.Sigma.html#209" class="InductiveConstructor Operator">,</a> <a id="7198" href="Relation.html#7198" class="Bound">c⟿d</a>      <a id="7207" class="Symbol">=</a> <a id="7209" href="Relation.html#7188" class="Bound">d</a> <a id="7211" href="Agda.Builtin.Sigma.html#209" class="InductiveConstructor Operator">,</a> <a id="7213" href="Relation.html#3573" class="InductiveConstructor">one</a> <a id="7217" href="Relation.html#7192" class="Bound">b⟿d</a> <a id="7221" href="Agda.Builtin.Sigma.html#209" class="InductiveConstructor Operator">,</a> <a id="7223" href="Relation.html#7198" class="Bound">c⟿d</a>
  <a id="7229" href="Relation.html#6961" class="Function">leg</a> <a id="7233" href="Relation.html#7233" class="Bound">♢</a> <a id="7235" href="Relation.html#7235" class="Bound">a⟿b</a> <a id="7239" class="Symbol">(</a><a id="7240" href="Relation.html#3634" class="InductiveConstructor">more</a> <a id="7245" href="Relation.html#7245" class="Bound">a⟿c</a> <a id="7249" href="Relation.html#7249" class="Bound">c⟿*dₙ</a><a id="7254" class="Symbol">)</a>
    <a id="7260" class="Keyword">with</a> <a id="7265" href="Relation.html#7233" class="Bound">♢</a> <a id="7267" href="Relation.html#7235" class="Bound">a⟿b</a> <a id="7271" href="Relation.html#7245" class="Bound">a⟿c</a>
  <a id="7277" class="Symbol">...</a> <a id="7281" class="Symbol">|</a> <a id="7283" href="Relation.html#7283" class="Bound">d₁</a> <a id="7286" href="Agda.Builtin.Sigma.html#209" class="InductiveConstructor Operator">,</a> <a id="7288" href="Relation.html#7288" class="Bound">b⟿d₁</a> <a id="7293" href="Agda.Builtin.Sigma.html#209" class="InductiveConstructor Operator">,</a> <a id="7295" href="Relation.html#7295" class="Bound">c⟿d₁</a>
    <a id="7304" class="Keyword">with</a> <a id="7309" href="Relation.html#6961" class="Function">leg</a> <a id="7313" class="Bound">♢</a> <a id="7315" href="Relation.html#7295" class="Bound">c⟿d₁</a> <a id="7320" class="Bound">c⟿*dₙ</a>
  <a id="7328" class="Symbol">...</a> <a id="7332" class="Symbol">|</a> <a id="7334" href="Relation.html#7334" class="Bound">dₙ</a> <a id="7337" href="Agda.Builtin.Sigma.html#209" class="InductiveConstructor Operator">,</a> <a id="7339" href="Relation.html#7339" class="Bound">e⟿*dₙ</a> <a id="7345" href="Agda.Builtin.Sigma.html#209" class="InductiveConstructor Operator">,</a> <a id="7347" href="Relation.html#7347" class="Bound">d⟿dₙ</a>  <a id="7353" class="Symbol">=</a> <a id="7355" href="Relation.html#7334" class="Bound">dₙ</a> <a id="7358" href="Agda.Builtin.Sigma.html#209" class="InductiveConstructor Operator">,</a> <a id="7360" href="Relation.html#3634" class="InductiveConstructor">more</a> <a id="7365" class="Bound">b⟿d₁</a> <a id="7370" href="Relation.html#7339" class="Bound">e⟿*dₙ</a> <a id="7376" href="Agda.Builtin.Sigma.html#209" class="InductiveConstructor Operator">,</a> <a id="7378" href="Relation.html#7347" class="Bound">d⟿dₙ</a>
<a id="7383" class="Markup">\end{code}</a><a id="7393" class="Background">

With this result at hand is easy to prove that the diamond property
implies Church-Rosser for the $n$-fold composition of the relation.
\begin{lemma}
Let $\reduction$ be diamantine, then it satisfies Church-Rosser for the
$n$-fold closure.
\end{lemma}
\begin{proof}
The proof is by induction on the second reduction and cases in the first one, using previous result all the non trivial cases. There exists another two cases symmetrical to the first two diagrams, so we omit them.

% base case
\noindent\begin{tikzpicture}[&gt;=latex,baseline,scale=0.8]
   \node (a) at (2,2) {$a$};
   \node (b) at (1,1) {$a$};
   \node (c) at (4,0) {$c$};
   \node (d) at (3,-1) {$c$};

   \draw [double] (a) -- (b) ;
   \draw [-&gt;] (a) -- (c) ;
   \draw[-&gt;] (b) -&gt; (d) ;
   \draw[double] (c) -&gt; (d) ;
\end{tikzpicture}
% one reduction
\begin{tikzpicture}[&gt;=latex,baseline,scale=0.8]
   \node (a) at (2,2) {$a$};
   \node (b) at (1,1) {$b$};
   \node (cn) at (4,0) {$c_n$};
   \node (dn) at (3,-1) {$d$};
   \node (ih) at (2,1) {leg};

   \draw [-&gt;] (a) -- (b) ;
   \draw [-&gt;] (a) -- (cn) ;
   \draw[-&gt;] (b) -&gt; (dn) ;
   \draw[-&gt;] (cn) -&gt; (dn) ;
\end{tikzpicture}
% more steps in both sides
\begin{tikzpicture}[&gt;=latex,baseline,scale=0.8]
   \node (a) at (2,2) {$a$};
   \node (b1) at (1,1) {$b_1$};
   \node (c1) at (3,1) {$c_1$};
   \node (bn) at (-1,-1) {$b_n$};
   \node (cn) at (5,-1) {$c_n$};
   \node (d1) at (0,-2) {$d_1$};
   \node (dn) at (2,-4) {$d_n$};
   \node (leg) at (1,0) {leg} ;
   \node (ih) at (3,-1) {i.h.};

   \draw [-&gt;] (a) -- (b1) ;
   \draw [-&gt;] (a) -- (c1) ;
   \draw [-&gt;] (b1) -- (bn) ;
   \draw [-&gt;] (c1) -- (cn) ;
   \draw[-&gt;] (c1) -&gt; (d1) ;
   \draw[-&gt;] (bn) -&gt; (d1) ;
   \draw[-&gt;] (d1) -&gt; (dn) ;
   \draw[-&gt;] (cn) -&gt; (dn) ;
\end{tikzpicture}
\end{proof}

</a><a id="9162" class="Markup">\begin{code}</a>
  <a id="diamond-cr-steps"></a><a id="9177" href="Relation.html#9177" class="Function">diamond-cr-steps</a> <a id="9194" class="Symbol">:</a> <a id="9196" class="Symbol">{</a><a id="9197" href="Relation.html#9197" class="Bound">⟿</a> <a id="9199" class="Symbol">:</a> <a id="9201" href="Relation.html#501" class="Function">Rel</a><a id="9204" class="Symbol">}</a> <a id="9206" class="Symbol">→</a> <a id="9208" href="Relation.html#4477" class="Function">diamond</a> <a id="9216" href="Relation.html#9197" class="Bound">⟿</a> <a id="9218" class="Symbol">→</a> <a id="9220" href="Relation.html#5258" class="Function">cr-steps</a> <a id="9229" href="Relation.html#9197" class="Bound">⟿</a>
  <a id="9233" href="Relation.html#9177" class="Function">diamond-cr-steps</a> <a id="9250" href="Relation.html#9250" class="Bound">♢</a> <a id="9252" class="Symbol">{</a><a id="9253" href="Relation.html#9253" class="Bound">a</a><a id="9254" class="Symbol">}</a> <a id="9256" class="Symbol">{</a><a id="9257" class="DottedPattern Symbol">.</a><a id="9258" href="Relation.html#9253" class="DottedPattern Bound">a</a><a id="9259" class="Symbol">}</a> <a id="9261" class="Symbol">{</a><a id="9262" href="Relation.html#9262" class="Bound">c</a><a id="9263" class="Symbol">}</a>   <a id="9267" href="Relation.html#3511" class="InductiveConstructor">zero</a>                  <a id="9289" href="Relation.html#9289" class="Bound">a⟿*c</a>
    <a id="9298" class="Symbol">=</a> <a id="9300" href="Relation.html#9262" class="Bound">c</a> <a id="9302" href="Agda.Builtin.Sigma.html#209" class="InductiveConstructor Operator">,</a> <a id="9304" href="Relation.html#9289" class="Bound">a⟿*c</a> <a id="9309" href="Agda.Builtin.Sigma.html#209" class="InductiveConstructor Operator">,</a> <a id="9311" href="Relation.html#3511" class="InductiveConstructor">zero</a>
  <a id="9318" href="Relation.html#9177" class="Function">diamond-cr-steps</a> <a id="9335" href="Relation.html#9335" class="Bound">♢</a>                <a id="9352" class="Symbol">(</a><a id="9353" href="Relation.html#3573" class="InductiveConstructor">one</a> <a id="9357" href="Relation.html#9357" class="Bound">a⟿b</a><a id="9360" class="Symbol">)</a>            <a id="9373" href="Relation.html#9373" class="Bound">a⟿*c</a>
    <a id="9382" class="Keyword">with</a> <a id="9387" href="Relation.html#6961" class="Function">leg</a> <a id="9391" href="Relation.html#9335" class="Bound">♢</a> <a id="9393" href="Relation.html#9357" class="Bound">a⟿b</a> <a id="9397" href="Relation.html#9373" class="Bound">a⟿*c</a>
  <a id="9404" class="Symbol">...</a> <a id="9408" class="Symbol">|</a> <a id="9410" href="Relation.html#9410" class="Bound">d</a> <a id="9412" href="Agda.Builtin.Sigma.html#209" class="InductiveConstructor Operator">,</a> <a id="9414" href="Relation.html#9414" class="Bound">b⟿*d</a> <a id="9419" href="Agda.Builtin.Sigma.html#209" class="InductiveConstructor Operator">,</a> <a id="9421" href="Relation.html#9421" class="Bound">c⟿d</a> <a id="9425" class="Symbol">=</a> <a id="9427" href="Relation.html#9410" class="Bound">d</a> <a id="9429" href="Agda.Builtin.Sigma.html#209" class="InductiveConstructor Operator">,</a> <a id="9431" href="Relation.html#9414" class="Bound">b⟿*d</a> <a id="9436" href="Agda.Builtin.Sigma.html#209" class="InductiveConstructor Operator">,</a> <a id="9438" href="Relation.html#3573" class="InductiveConstructor">one</a> <a id="9442" href="Relation.html#9421" class="Bound">c⟿d</a>
  <a id="9448" href="Relation.html#9177" class="Function">diamond-cr-steps</a> <a id="9465" href="Relation.html#9465" class="Bound">♢</a> <a id="9467" class="Symbol">{</a><a id="9468" href="Relation.html#9468" class="Bound">a</a><a id="9469" class="Symbol">}</a> <a id="9471" class="Symbol">{</a><a id="9472" href="Relation.html#9472" class="Bound">bₙ</a><a id="9474" class="Symbol">}</a> <a id="9476" class="Symbol">{</a><a id="9477" class="DottedPattern Symbol">.</a><a id="9478" href="Relation.html#9468" class="DottedPattern Bound">a</a><a id="9479" class="Symbol">}</a>  <a id="9482" class="Symbol">(</a><a id="9483" href="Relation.html#3634" class="InductiveConstructor">more</a> <a id="9488" href="Relation.html#9488" class="Bound">a⟿b₁</a> <a id="9493" href="Relation.html#9493" class="Bound">b₁⟿*bₙ</a><a id="9499" class="Symbol">)</a>  <a id="9502" href="Relation.html#3511" class="InductiveConstructor">zero</a>
    <a id="9511" class="Symbol">=</a> <a id="9513" href="Relation.html#9472" class="Bound">bₙ</a> <a id="9516" href="Agda.Builtin.Sigma.html#209" class="InductiveConstructor Operator">,</a> <a id="9518" href="Relation.html#3511" class="InductiveConstructor">zero</a> <a id="9523" href="Agda.Builtin.Sigma.html#209" class="InductiveConstructor Operator">,</a> <a id="9525" href="Relation.html#3634" class="InductiveConstructor">more</a> <a id="9530" href="Relation.html#9488" class="Bound">a⟿b₁</a> <a id="9535" href="Relation.html#9493" class="Bound">b₁⟿*bₙ</a>
  <a id="9544" href="Relation.html#9177" class="Function">diamond-cr-steps</a> <a id="9561" href="Relation.html#9561" class="Bound">♢</a>                <a id="9578" class="Symbol">(</a><a id="9579" href="Relation.html#3634" class="InductiveConstructor">more</a> <a id="9584" href="Relation.html#9584" class="Bound">a⟿b₁</a> <a id="9589" href="Relation.html#9589" class="Bound">b₁⟿*bₙ</a><a id="9595" class="Symbol">)</a>  <a id="9598" class="Symbol">(</a><a id="9599" href="Relation.html#3573" class="InductiveConstructor">one</a> <a id="9603" href="Relation.html#9603" class="Bound">a⟿c</a><a id="9606" class="Symbol">)</a>
    <a id="9612" class="Keyword">with</a> <a id="9617" href="Relation.html#6961" class="Function">leg</a> <a id="9621" href="Relation.html#9561" class="Bound">♢</a> <a id="9623" href="Relation.html#9603" class="Bound">a⟿c</a> <a id="9627" class="Symbol">(</a><a id="9628" href="Relation.html#3634" class="InductiveConstructor">more</a> <a id="9633" href="Relation.html#9584" class="Bound">a⟿b₁</a> <a id="9638" href="Relation.html#9589" class="Bound">b₁⟿*bₙ</a><a id="9644" class="Symbol">)</a>
  <a id="9648" class="Symbol">...</a> <a id="9652" class="Symbol">|</a> <a id="9654" href="Relation.html#9654" class="Bound">d</a> <a id="9656" href="Agda.Builtin.Sigma.html#209" class="InductiveConstructor Operator">,</a> <a id="9658" href="Relation.html#9658" class="Bound">c⟿*d</a> <a id="9663" href="Agda.Builtin.Sigma.html#209" class="InductiveConstructor Operator">,</a> <a id="9665" href="Relation.html#9665" class="Bound">bₙ⟿d</a> <a id="9670" class="Symbol">=</a> <a id="9672" href="Relation.html#9654" class="Bound">d</a> <a id="9674" href="Agda.Builtin.Sigma.html#209" class="InductiveConstructor Operator">,</a> <a id="9676" href="Relation.html#3573" class="InductiveConstructor">one</a> <a id="9680" href="Relation.html#9665" class="Bound">bₙ⟿d</a> <a id="9685" href="Agda.Builtin.Sigma.html#209" class="InductiveConstructor Operator">,</a> <a id="9687" href="Relation.html#9658" class="Bound">c⟿*d</a>
  <a id="9694" href="Relation.html#9177" class="Function">diamond-cr-steps</a> <a id="9711" href="Relation.html#9711" class="Bound">♢</a>                <a id="9728" class="Symbol">(</a><a id="9729" href="Relation.html#3634" class="InductiveConstructor">more</a> <a id="9734" href="Relation.html#9734" class="Bound">a⟿b₁</a> <a id="9739" href="Relation.html#9739" class="Bound">b₁⟿*bₙ</a><a id="9745" class="Symbol">)</a>  <a id="9748" class="Symbol">(</a><a id="9749" href="Relation.html#3634" class="InductiveConstructor">more</a> <a id="9754" href="Relation.html#9754" class="Bound">a⟿c₁</a> <a id="9759" href="Relation.html#9759" class="Bound">c₁⟿*cₙ</a><a id="9765" class="Symbol">)</a>
    <a id="9771" class="Keyword">with</a> <a id="9776" href="Relation.html#6961" class="Function">leg</a> <a id="9780" href="Relation.html#9711" class="Bound">♢</a> <a id="9782" href="Relation.html#9754" class="Bound">a⟿c₁</a> <a id="9787" class="Symbol">(</a><a id="9788" href="Relation.html#3634" class="InductiveConstructor">more</a> <a id="9793" href="Relation.html#9734" class="Bound">a⟿b₁</a> <a id="9798" href="Relation.html#9739" class="Bound">b₁⟿*bₙ</a><a id="9804" class="Symbol">)</a>
  <a id="9808" class="Symbol">...</a> <a id="9812" class="Symbol">|</a> <a id="9814" href="Relation.html#9814" class="Bound">d₁</a> <a id="9817" href="Agda.Builtin.Sigma.html#209" class="InductiveConstructor Operator">,</a> <a id="9819" href="Relation.html#9819" class="Bound">c₁⟿*d₁</a> <a id="9826" href="Agda.Builtin.Sigma.html#209" class="InductiveConstructor Operator">,</a> <a id="9828" href="Relation.html#9828" class="Bound">bₙ⟿d₁</a>
    <a id="9838" class="Keyword">with</a> <a id="9843" href="Relation.html#9177" class="Function">diamond-cr-steps</a> <a id="9860" class="Bound">♢</a> <a id="9862" href="Relation.html#9819" class="Bound">c₁⟿*d₁</a> <a id="9869" class="Bound">c₁⟿*cₙ</a>
  <a id="9878" class="Symbol">...</a> <a id="9882" class="Symbol">|</a> <a id="9884" href="Relation.html#9884" class="Bound">dₙ</a> <a id="9887" href="Agda.Builtin.Sigma.html#209" class="InductiveConstructor Operator">,</a> <a id="9889" href="Relation.html#9889" class="Bound">d₁⟿*dₙ</a> <a id="9896" href="Agda.Builtin.Sigma.html#209" class="InductiveConstructor Operator">,</a> <a id="9898" href="Relation.html#9898" class="Bound">cₙ⟿*dₙ</a>
    <a id="9909" class="Symbol">=</a> <a id="9911" href="Relation.html#9884" class="Bound">dₙ</a> <a id="9914" href="Agda.Builtin.Sigma.html#209" class="InductiveConstructor Operator">,</a> <a id="9916" href="Relation.html#3634" class="InductiveConstructor">more</a> <a id="9921" class="Bound">bₙ⟿d₁</a>  <a id="9928" href="Relation.html#9889" class="Bound">d₁⟿*dₙ</a> <a id="9935" href="Agda.Builtin.Sigma.html#209" class="InductiveConstructor Operator">,</a> <a id="9937" href="Relation.html#9898" class="Bound">cₙ⟿*dₙ</a>
<a id="9944" class="Markup">\end{code}</a><a id="9954" class="Background">

Since both statements of the transitive closure are equivalent,
from cr-steps we can deduce church-rosser for any relation having
the diamond property.

</a><a id="10109" class="Markup">\begin{code}</a>
  <a id="diamond-cr"></a><a id="10124" href="Relation.html#10124" class="Function">diamond-cr</a> <a id="10135" class="Symbol">:</a> <a id="10137" class="Symbol">{</a><a id="10138" href="Relation.html#10138" class="Bound">⟿</a> <a id="10140" class="Symbol">:</a> <a id="10142" href="Relation.html#501" class="Function">Rel</a><a id="10145" class="Symbol">}</a> <a id="10147" class="Symbol">→</a> <a id="10149" href="Relation.html#4477" class="Function">diamond</a> <a id="10157" href="Relation.html#10138" class="Bound">⟿</a> <a id="10159" class="Symbol">→</a> <a id="10161" href="Relation.html#5206" class="Function">cr</a> <a id="10164" href="Relation.html#10138" class="Bound">⟿</a>
  <a id="10168" href="Relation.html#10124" class="Function">diamond-cr</a> <a id="10179" href="Relation.html#10179" class="Bound">♢</a> <a id="10181" class="Symbol">=</a> <a id="10183" href="Relation.html#5323" class="Function">cr-steps-to-cr</a> <a id="10198" class="Symbol">(</a><a id="10199" href="Relation.html#9177" class="Function">diamond-cr-steps</a> <a id="10216" href="Relation.html#10179" class="Bound">♢</a><a id="10217" class="Symbol">)</a>
<a id="10219" class="Markup">\end{code}</a><a id="10229" class="Background">

\begin{lemma}
Let $R$ and $S$ be two relations such that $S\subseteq R$ and $\transclos R\subseteq S$, if
$R$ is Church-Rosser, then $S$ is also.
\end{lemma}
\begin{proof}
The proof is immediate: let $a\,\transclos S\,b$ and $a\,\transclos S\,c$, by the first hypothesis and $mon-star$\ lemma
we know both $a\,\transclos R\,b$ and $a\,\transclos R\,c$. By Church-Rosser for $R$ we get an element
$d$ with proofs of $b\,\transclos R\,d$ and $c\,\transclos R\,d$; by the second hypothesis and $trans-⊆-star$\ lemma we conclude
$b\,\transclos S\,d$ and $c\,\transclos S\,d$.
\end{proof}

</a><a id="10816" class="Markup">\begin{code}</a>
  <a id="cr-⊆"></a><a id="10831" href="Relation.html#10831" class="Function">cr-⊆</a> <a id="10836" class="Symbol">:</a> <a id="10838" class="Symbol">{</a><a id="10839" href="Relation.html#10839" class="Bound">R</a> <a id="10841" href="Relation.html#10841" class="Bound">S</a> <a id="10843" class="Symbol">:</a> <a id="10845" href="Relation.html#501" class="Function">Rel</a><a id="10848" class="Symbol">}</a> <a id="10850" class="Symbol">→</a> <a id="10852" href="Relation.html#10841" class="Bound">S</a> <a id="10854" href="Relation.html#1288" class="Function Operator">⊆</a> <a id="10856" href="Relation.html#10839" class="Bound">R</a> <a id="10858" class="Symbol">→</a> <a id="10860" href="Relation.html#10839" class="Bound">R</a> <a id="10862" href="Relation.html#1288" class="Function Operator">⊆</a> <a id="10864" href="Relation.html#2093" class="Datatype">star</a> <a id="10869" href="Relation.html#10841" class="Bound">S</a> <a id="10871" class="Symbol">→</a> <a id="10873" href="Relation.html#5206" class="Function">cr</a> <a id="10876" href="Relation.html#10839" class="Bound">R</a> <a id="10878" class="Symbol">→</a> <a id="10880" href="Relation.html#5206" class="Function">cr</a> <a id="10883" href="Relation.html#10841" class="Bound">S</a>
  <a id="10887" href="Relation.html#10831" class="Function">cr-⊆</a> <a id="10892" href="Relation.html#10892" class="Bound">S⊆R</a> <a id="10896" href="Relation.html#10896" class="Bound">R⊆S⋆</a> <a id="10901" href="Relation.html#10901" class="Bound">cr</a> <a id="10904" href="Relation.html#10904" class="Bound">aR⋆b</a> <a id="10909" href="Relation.html#10909" class="Bound">aR⋆c</a>
    <a id="10918" class="Keyword">with</a> <a id="10923" href="Relation.html#10901" class="Bound">cr</a> <a id="10926" class="Symbol">(</a><a id="10927" href="Relation.html#2255" class="Function">mon-star</a> <a id="10936" href="Relation.html#10892" class="Bound">S⊆R</a> <a id="10940" href="Relation.html#10904" class="Bound">aR⋆b</a><a id="10944" class="Symbol">)</a> <a id="10946" class="Symbol">(</a><a id="10947" href="Relation.html#2255" class="Function">mon-star</a> <a id="10956" href="Relation.html#10892" class="Bound">S⊆R</a> <a id="10960" href="Relation.html#10909" class="Bound">aR⋆c</a><a id="10964" class="Symbol">)</a>
  <a id="10968" class="Symbol">...</a> <a id="10972" class="Symbol">|</a> <a id="10974" href="Relation.html#10974" class="Bound">d</a> <a id="10976" href="Agda.Builtin.Sigma.html#209" class="InductiveConstructor Operator">,</a> <a id="10978" href="Relation.html#10978" class="Bound">bR⋆d</a> <a id="10983" href="Agda.Builtin.Sigma.html#209" class="InductiveConstructor Operator">,</a> <a id="10985" href="Relation.html#10985" class="Bound">cR⋆d</a>
    <a id="10994" class="Symbol">=</a>  <a id="10997" href="Relation.html#10974" class="Bound">d</a>                       <a id="11021" href="Agda.Builtin.Sigma.html#209" class="InductiveConstructor Operator">,</a>
       <a id="11030" href="Relation.html#2637" class="Function">trans-⊆-star</a> <a id="11043" class="Bound">R⊆S⋆</a> <a id="11048" href="Relation.html#10978" class="Bound">bR⋆d</a>  <a id="11054" href="Agda.Builtin.Sigma.html#209" class="InductiveConstructor Operator">,</a>
       <a id="11063" href="Relation.html#2637" class="Function">trans-⊆-star</a> <a id="11076" class="Bound">R⊆S⋆</a> <a id="11081" href="Relation.html#10985" class="Bound">cR⋆d</a>
<a id="11086" class="Markup">\end{code}</a><a id="11096" class="Background">
%&lt;/Relation&gt;

\end{document}
</a></pre></body></html>